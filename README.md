# 图片压缩工具 (Image Compressor)

一个纯前端的图片压缩工具，支持 JPEG/PNG/WebP/AVIF 格式的质量压缩与等比缩放，完全在浏览器本地处理，无需后端服务器。

## 特性

- **纯本地处理**: 所有图片处理都在浏览器中完成，不上传到任何服务器，保护隐私
- **多格式支持**: 支持 JPEG、PNG、WebP、AVIF 四种主流图片格式
- **批量处理**: 支持同时处理多张图片，自动队列处理
- **拖拽上传**: 支持拖拽文件到页面，也可点击选择文件
- **灵活配置**:
  - 质量调节（0-1）
  - 最大宽度/高度限制
  - 输出格式选择
- **实时预览**: 压缩前后对比，显示尺寸、体积和压缩率
- **Web Worker**: 使用 Web Worker 处理大图，避免主线程阻塞
- **批量下载**: 支持单张下载或批量打包为 ZIP 文件
- **响应式设计**: 支持桌面和移动端，自适应暗色/浅色模式
- **元数据处理**: 自动去除 EXIF 等元数据（图片旋转方向已考虑）

## 快速开始

### 在线使用

1. 直接在 StackBlitz 打开：
   - 上传 `index.html` 到 StackBlitz
   - 或访问本地文件：用浏览器打开 `index.html`

2. 本地使用：
   ```bash
   # 克隆或下载文件
   # 用浏览器打开 index.html
   open index.html  # macOS
   # 或
   start index.html  # Windows
   ```

### 使用步骤

1. **上传图片**
   - 拖拽图片到上传区域
   - 或点击上传区域选择文件
   - 支持一次选择多张图片

2. **调整设置**
   - 选择输出格式（JPEG/PNG/WebP/AVIF）
   - 调整图片质量（0-1，推荐 0.7-0.9）
   - 设置最大宽度/高度（0 表示不限制）

3. **开始压缩**
   - 点击"开始压缩"按钮
   - 等待处理完成（大图会使用 Web Worker）

4. **下载图片**
   - 单张下载：点击每张图片下方的"下载"按钮
   - 批量下载：点击"下载全部（ZIP）"打包所有图片

## 技术栈

- **纯 HTML5 + JavaScript**
- **Canvas API**: 图片处理和压缩
- **OffscreenCanvas**: Web Worker 中的高性能渲染
- **Web Worker**: 多线程处理，避免 UI 卡顿
- **JSZip**: 批量打包 ZIP 文件
- **CSS Grid + Flexbox**: 响应式布局
- **CSS 变量**: 暗色/浅色模式

## 浏览器兼容性

- ✅ Chrome/Edge 90+
- ✅ Safari 15+
- ✅ Firefox 90+
- ⚠️ AVIF 格式需要较新的浏览器版本
- ⚠️ OffscreenCanvas 需要浏览器支持（Chrome 69+, Firefox 105+）

## 验收测试

按照项目要求的验收标准：

1. **打开页面即可用**: ✅ 单文件设计，双击打开即用
2. **拖拽 10 张 4000×3000 的 JPG**: ✅ 支持批量拖拽上传
3. **压缩到 2000px、quality=0.8**: ✅ 可配置最大尺寸和质量
4. **页面无卡死**: ✅ Web Worker 处理，并发控制为 3
5. **导出成功**: ✅ 单张下载 + ZIP 批量下载
6. **展示原/压后尺寸、体积与压缩率**: ✅ 每张图片都有详细统计

## 性能优化

- **并发控制**: 同时最多处理 3 张图片，避免内存溢出
- **Web Worker**: 大图处理不阻塞主线程
- **内存释放**: 及时释放 ObjectURL 和 Worker
- **懒加载**: 只在需要时创建 Worker

## 文件结构

```
image-compressor/
├── index.html          # 单文件应用（包含所有代码）
└── README.md           # 使用说明
```

## 常见问题

### Q: AVIF 格式压缩失败？
A: 部分浏览器不支持 AVIF 格式，建议使用 Chrome 90+ 或 Edge 90+

### Q: 大图压缩很慢？
A: 大图（如 10000×10000）需要更多处理时间，请耐心等待。已使用 Web Worker 避免页面卡死

### Q: 压缩后文件反而变大？
A: 可能是：
- PNG 转 JPEG 时质量设置过高
- 原图已经过高度压缩
- 建议降低质量参数或尝试其他格式

### Q: 移动端能用吗？
A: 可以，但大图可能受设备性能限制。建议在桌面浏览器处理大量/大尺寸图片

## 许可证

MIT License - 自由使用

## 贡献

欢迎提交 Issue 和 Pull Request！

---

**注意**: 本工具完全在浏览器本地运行，不会上传图片到任何服务器，请放心使用。
